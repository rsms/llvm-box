# sysroot templates

## macOS

macOS libSystem (aka libc) is always dynamically linked.
Symbol table files at `libc/lib/any-macos/*.tbd` are manually copied from SDKs.
On a

```
MACOS_SDK=$(xcrun -sdk macosx --show-sdk-path)
MACOS_SDK_V=$(basename "$MACOS_SDK" .sdk | sed -E 's/^.+[^0-9]([0-9]+)\..+$/\1/')

cp $MACOS_SDK/usr/lib/libSystem.tbd \
   llvmbox/sysroot-template/libc/lib/any-macos/libSystem.$MACOS_SDK_V.tbd
```


macos headers generated by <https://github.com/ziglang/fetch-them-macos-headers>

On a macOS host:

```sh
git clone https://github.com/ziglang/fetch-them-macos-headers.git
cd fetch-them-macos-headers
zig build  # get zig from https://ziglang.org/download/
./zig-out/bin/fetch_them_macos_headers fetch
./zig-out/bin/fetch_them_macos_headers generate llvmbox/sysroot-template/libc-headers

# fixup names
cd llvmbox/sysroot-template/libc-headers
for f in *-none; do mv -v $f ${f/-none/}; done
for f in any-*-any; do mv -v $f ${f/-any/}; done
```

